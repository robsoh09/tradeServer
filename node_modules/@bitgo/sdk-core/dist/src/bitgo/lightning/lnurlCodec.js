"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.decodeLnurl = exports.encodeLnurl = void 0;
const bech32_1 = require("bech32");
function encodeLnurl(url) {
    return bech32_1.bech32.encode('lnurl', bech32_1.bech32.toWords(Buffer.from(url)));
}
exports.encodeLnurl = encodeLnurl;
function decodeLnurl(lnurl) {
    const splittedLnurl = lnurl.split(':');
    let parsedLnurl;
    if (splittedLnurl.length === 2) {
        if (splittedLnurl[0] !== 'lightning') {
            throw new Error('invalid lnurl');
        }
        parsedLnurl = splittedLnurl[1];
    }
    else {
        parsedLnurl = splittedLnurl[0];
    }
    const { prefix, words } = bech32_1.bech32.decode(parsedLnurl, 2000);
    if (prefix !== 'lnurl') {
        throw new Error('invalid lnurl');
    }
    return Buffer.from(bech32_1.bech32.fromWords(words)).toString();
}
exports.decodeLnurl = decodeLnurl;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG51cmxDb2RlYy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9iaXRnby9saWdodG5pbmcvbG51cmxDb2RlYy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBQSxtQ0FBZ0M7QUFFaEMsU0FBZ0IsV0FBVyxDQUFDLEdBQVc7SUFDckMsT0FBTyxlQUFNLENBQUMsTUFBTSxDQUFDLE9BQU8sRUFBRSxlQUFNLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ2xFLENBQUM7QUFGRCxrQ0FFQztBQUVELFNBQWdCLFdBQVcsQ0FBQyxLQUFhO0lBQ3ZDLE1BQU0sYUFBYSxHQUFHLEtBQUssQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUM7SUFFdkMsSUFBSSxXQUFtQixDQUFDO0lBQ3hCLElBQUksYUFBYSxDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUU7UUFDOUIsSUFBSSxhQUFhLENBQUMsQ0FBQyxDQUFDLEtBQUssV0FBVyxFQUFFO1lBQ3BDLE1BQU0sSUFBSSxLQUFLLENBQUMsZUFBZSxDQUFDLENBQUM7U0FDbEM7UUFDRCxXQUFXLEdBQUcsYUFBYSxDQUFDLENBQUMsQ0FBQyxDQUFDO0tBQ2hDO1NBQU07UUFDTCxXQUFXLEdBQUcsYUFBYSxDQUFDLENBQUMsQ0FBQyxDQUFDO0tBQ2hDO0lBQ0QsTUFBTSxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUUsR0FBRyxlQUFNLENBQUMsTUFBTSxDQUFDLFdBQVcsRUFBRSxJQUFJLENBQUMsQ0FBQztJQUUzRCxJQUFJLE1BQU0sS0FBSyxPQUFPLEVBQUU7UUFDdEIsTUFBTSxJQUFJLEtBQUssQ0FBQyxlQUFlLENBQUMsQ0FBQztLQUNsQztJQUVELE9BQU8sTUFBTSxDQUFDLElBQUksQ0FBQyxlQUFNLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsUUFBUSxFQUFFLENBQUM7QUFDekQsQ0FBQztBQW5CRCxrQ0FtQkMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBiZWNoMzIgfSBmcm9tICdiZWNoMzInO1xuXG5leHBvcnQgZnVuY3Rpb24gZW5jb2RlTG51cmwodXJsOiBzdHJpbmcpIHtcbiAgcmV0dXJuIGJlY2gzMi5lbmNvZGUoJ2xudXJsJywgYmVjaDMyLnRvV29yZHMoQnVmZmVyLmZyb20odXJsKSkpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZGVjb2RlTG51cmwobG51cmw6IHN0cmluZykge1xuICBjb25zdCBzcGxpdHRlZExudXJsID0gbG51cmwuc3BsaXQoJzonKTtcblxuICBsZXQgcGFyc2VkTG51cmw6IHN0cmluZztcbiAgaWYgKHNwbGl0dGVkTG51cmwubGVuZ3RoID09PSAyKSB7XG4gICAgaWYgKHNwbGl0dGVkTG51cmxbMF0gIT09ICdsaWdodG5pbmcnKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ2ludmFsaWQgbG51cmwnKTtcbiAgICB9XG4gICAgcGFyc2VkTG51cmwgPSBzcGxpdHRlZExudXJsWzFdO1xuICB9IGVsc2Uge1xuICAgIHBhcnNlZExudXJsID0gc3BsaXR0ZWRMbnVybFswXTtcbiAgfVxuICBjb25zdCB7IHByZWZpeCwgd29yZHMgfSA9IGJlY2gzMi5kZWNvZGUocGFyc2VkTG51cmwsIDIwMDApO1xuXG4gIGlmIChwcmVmaXggIT09ICdsbnVybCcpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ2ludmFsaWQgbG51cmwnKTtcbiAgfVxuXG4gIHJldHVybiBCdWZmZXIuZnJvbShiZWNoMzIuZnJvbVdvcmRzKHdvcmRzKSkudG9TdHJpbmcoKTtcbn1cbiJdfQ==