"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports._encryptRsa = void 0;
const crypto_1 = __importDefault(require("crypto"));
/**
 * Encrypts a string using RSA
 * @param {string} publicKey The public key to use for encryption
 * @param {string} text The text to encrypt
 * @returns {string} The encrypted text
 */
function _encryptRsa(publicKey, text) {
    const key = crypto_1.default.createPublicKey(publicKey);
    const encryptedData = crypto_1.default.publicEncrypt({
        key,
        padding: crypto_1.default.constants.RSA_PKCS1_OAEP_PADDING,
        oaepHash: 'sha256',
    }, Buffer.from(text));
    return encryptedData.toString('base64');
}
exports._encryptRsa = _encryptRsa;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZW5jcnlwdC1yc2EuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvYml0Z28vdHJhZGluZy9uZXR3b3JrL2VuY3J5cHQtcnNhLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLG9EQUE0QjtBQUU1Qjs7Ozs7R0FLRztBQUNILFNBQWdCLFdBQVcsQ0FBQyxTQUFpQixFQUFFLElBQVk7SUFDekQsTUFBTSxHQUFHLEdBQUcsZ0JBQU0sQ0FBQyxlQUFlLENBQUMsU0FBUyxDQUFDLENBQUM7SUFDOUMsTUFBTSxhQUFhLEdBQUcsZ0JBQU0sQ0FBQyxhQUFhLENBQ3hDO1FBQ0UsR0FBRztRQUNILE9BQU8sRUFBRSxnQkFBTSxDQUFDLFNBQVMsQ0FBQyxzQkFBc0I7UUFDaEQsUUFBUSxFQUFFLFFBQVE7S0FDbkIsRUFDRCxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUNsQixDQUFDO0lBRUYsT0FBTyxhQUFhLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDO0FBQzFDLENBQUM7QUFaRCxrQ0FZQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBjcnlwdG8gZnJvbSAnY3J5cHRvJztcblxuLyoqXG4gKiBFbmNyeXB0cyBhIHN0cmluZyB1c2luZyBSU0FcbiAqIEBwYXJhbSB7c3RyaW5nfSBwdWJsaWNLZXkgVGhlIHB1YmxpYyBrZXkgdG8gdXNlIGZvciBlbmNyeXB0aW9uXG4gKiBAcGFyYW0ge3N0cmluZ30gdGV4dCBUaGUgdGV4dCB0byBlbmNyeXB0XG4gKiBAcmV0dXJucyB7c3RyaW5nfSBUaGUgZW5jcnlwdGVkIHRleHRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIF9lbmNyeXB0UnNhKHB1YmxpY0tleTogc3RyaW5nLCB0ZXh0OiBzdHJpbmcpOiBzdHJpbmcge1xuICBjb25zdCBrZXkgPSBjcnlwdG8uY3JlYXRlUHVibGljS2V5KHB1YmxpY0tleSk7XG4gIGNvbnN0IGVuY3J5cHRlZERhdGEgPSBjcnlwdG8ucHVibGljRW5jcnlwdChcbiAgICB7XG4gICAgICBrZXksXG4gICAgICBwYWRkaW5nOiBjcnlwdG8uY29uc3RhbnRzLlJTQV9QS0NTMV9PQUVQX1BBRERJTkcsXG4gICAgICBvYWVwSGFzaDogJ3NoYTI1NicsXG4gICAgfSxcbiAgICBCdWZmZXIuZnJvbSh0ZXh0KVxuICApO1xuXG4gIHJldHVybiBlbmNyeXB0ZWREYXRhLnRvU3RyaW5nKCdiYXNlNjQnKTtcbn1cbiJdfQ==