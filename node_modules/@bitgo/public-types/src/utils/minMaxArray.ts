import * as t from "io-ts";

export interface IMinMaxArray<T> extends Array<T> {
  readonly minMaxArray: unique symbol;
}

/**
 * A helper that creates an array codec that limits the length of the array between [min, max]
 * @param codec
 * @param {min, max}
 */
export const minMaxArray = <C extends t.Mixed>(
  codec: C,
  {
    min,
    max,
  }: {
    min?: number;
    max?: number;
  } = {},
) =>
  t.brand(
    t.array(codec),
    (n: C[]): n is t.Branded<C[], IMinMaxArray<C>> =>
      (!min || min <= n.length) && (!max || n.length <= max),
    "minMaxArray",
  );
