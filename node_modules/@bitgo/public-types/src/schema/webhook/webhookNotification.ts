import * as t from "io-ts";
import { DateFromISOString } from "io-ts-types";

export const WebhookNotification = t.intersection([
  t.type({
    id: t.string,
  }),
  t.partial({
    type: t.string,
    wallet: t.string,
    url: t.string,
    hash: t.string,
    coin: t.string,
    coinChain: t.string,
    transfer: t.string,
    state: t.string,
    simulation: t.boolean,
    retries: t.number,
    webhook: t.string,
    updatedAt: DateFromISOString,
    nextAttempt: DateFromISOString,
    version: t.number,
    allowBlockedHosts: t.boolean,
    heightToConfirm: t.number,
    payload: t.string,
    response: t.partial({
      code: t.unknown,
      type: t.string,
      body: t.string,
      error: t.string,
    }),
  }),
]);
