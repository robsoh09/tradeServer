"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.PaginatedObjectsResponse = exports.CheckpointedObjectId = exports.getMovePackageContent = exports.hasPublicTransfer = exports.getMoveObject = exports.getObjectFields = exports.getMoveObjectType = exports.isImmutableObject = exports.isSharedObject = exports.getSharedObjectInitialVersion = exports.getObjectDisplay = exports.getObjectOwner = exports.getObjectPreviousTransactionDigest = exports.getObjectType = exports.isSuiObjectResponse = exports.getObjectVersion = exports.getObjectId = exports.getObjectReference = exports.getObjectNotExistsResponse = exports.getObjectDeletedResponse = exports.getSuiObjectData = exports.SuiObjectResponse = exports.SuiObjectResponseError = exports.GetOwnedObjectsResponse = exports.ObjectStatus = exports.SuiObjectDataOptions = exports.SuiObjectData = exports.ObjectDigest = exports.MIST_PER_SUI = exports.SuiRawData = exports.SuiRawMovePackage = exports.SuiRawMoveObject = exports.SuiParsedData = exports.SuiMovePackage = exports.SuiMoveObject = exports.MovePackageContent = exports.ObjectContentFields = exports.SuiObjectInfo = exports.SuiGasData = exports.SuiObjectRef = exports.ObjectType = void 0;
const superstruct_1 = require("superstruct");
const common_1 = require("./common");
exports.ObjectType = (0, superstruct_1.union)([(0, superstruct_1.string)(), (0, superstruct_1.literal)('package')]);
exports.SuiObjectRef = (0, superstruct_1.object)({
    /** Base64 string representing the object digest */
    digest: common_1.TransactionDigest,
    /** Hex code as string representing the object id */
    objectId: (0, superstruct_1.string)(),
    /** Object version */
    version: (0, superstruct_1.union)([(0, superstruct_1.number)(), (0, superstruct_1.string)()]),
});
exports.SuiGasData = (0, superstruct_1.object)({
    payment: (0, superstruct_1.array)(exports.SuiObjectRef),
    /** Gas Object's owner */
    owner: (0, superstruct_1.string)(),
    price: (0, superstruct_1.number)(),
    budget: (0, superstruct_1.number)(),
});
exports.SuiObjectInfo = (0, superstruct_1.assign)(exports.SuiObjectRef, (0, superstruct_1.object)({
    type: (0, superstruct_1.string)(),
    owner: common_1.ObjectOwner,
    previousTransaction: common_1.TransactionDigest,
}));
exports.ObjectContentFields = (0, superstruct_1.record)((0, superstruct_1.string)(), (0, superstruct_1.any)());
exports.MovePackageContent = (0, superstruct_1.record)((0, superstruct_1.string)(), (0, superstruct_1.string)());
exports.SuiMoveObject = (0, superstruct_1.object)({
    /** Move type (e.g., "0x2::coin::Coin<0x2::sui::SUI>") */
    type: (0, superstruct_1.string)(),
    /** Fields and values stored inside the Move object */
    fields: exports.ObjectContentFields,
    hasPublicTransfer: (0, superstruct_1.boolean)(),
});
exports.SuiMovePackage = (0, superstruct_1.object)({
    /** A mapping from module name to disassembled Move bytecode */
    disassembled: exports.MovePackageContent,
});
exports.SuiParsedData = (0, superstruct_1.union)([
    (0, superstruct_1.assign)(exports.SuiMoveObject, (0, superstruct_1.object)({ dataType: (0, superstruct_1.literal)('moveObject') })),
    (0, superstruct_1.assign)(exports.SuiMovePackage, (0, superstruct_1.object)({ dataType: (0, superstruct_1.literal)('package') })),
]);
exports.SuiRawMoveObject = (0, superstruct_1.object)({
    /** Move type (e.g., "0x2::coin::Coin<0x2::sui::SUI>") */
    type: (0, superstruct_1.string)(),
    hasPublicTransfer: (0, superstruct_1.boolean)(),
    version: common_1.SequenceNumber,
    bcsBytes: (0, superstruct_1.array)((0, superstruct_1.number)()),
});
exports.SuiRawMovePackage = (0, superstruct_1.object)({
    id: common_1.ObjectId,
    /** A mapping from module name to Move bytecode enocded in base64*/
    moduleMap: (0, superstruct_1.record)((0, superstruct_1.string)(), (0, superstruct_1.string)()),
});
// TODO(chris): consolidate SuiRawParsedData and SuiRawObject using generics
exports.SuiRawData = (0, superstruct_1.union)([
    (0, superstruct_1.assign)(exports.SuiMoveObject, (0, superstruct_1.object)({ dataType: (0, superstruct_1.literal)('moveObject') })),
    (0, superstruct_1.assign)(exports.SuiRawMovePackage, (0, superstruct_1.object)({ dataType: (0, superstruct_1.literal)('package') })),
]);
exports.MIST_PER_SUI = BigInt(1000000000);
exports.ObjectDigest = (0, superstruct_1.string)();
exports.SuiObjectData = (0, superstruct_1.object)({
    objectId: common_1.ObjectId,
    version: common_1.SequenceNumber,
    digest: exports.ObjectDigest,
    /**
     * Type of the object, default to be undefined unless SuiObjectDataOptions.showType is set to true
     */
    type: (0, superstruct_1.optional)((0, superstruct_1.string)()),
    /**
     * Move object content or package content, default to be undefined unless SuiObjectDataOptions.showContent is set to true
     */
    content: (0, superstruct_1.optional)(exports.SuiParsedData),
    /**
     * Move object content or package content in BCS bytes, default to be undefined unless SuiObjectDataOptions.showBcs is set to true
     */
    bcs: (0, superstruct_1.optional)(exports.SuiRawData),
    /**
     * The owner of this object. Default to be undefined unless SuiObjectDataOptions.showOwner is set to true
     */
    owner: (0, superstruct_1.optional)(common_1.ObjectOwner),
    /**
     * The digest of the transaction that created or last mutated this object.
     * Default to be undefined unless SuiObjectDataOptions.showPreviousTransaction is set to true
     */
    previousTransaction: (0, superstruct_1.optional)(common_1.TransactionDigest),
    /**
     * The amount of SUI we would rebate if this object gets deleted.
     * This number is re-calculated each time the object is mutated based on
     * the present storage gas price.
     * Default to be undefined unless SuiObjectDataOptions.showStorageRebate is set to true
     */
    storageRebate: (0, superstruct_1.optional)((0, superstruct_1.number)()),
    /**
     * Display metadata for this object, default to be undefined unless SuiObjectDataOptions.showDisplay is set to true
     * This can also be None if the struct type does not have Display defined
     * See more details in https://forums.sui.io/t/nft-object-display-proposal/4872
     */
    display: (0, superstruct_1.optional)((0, superstruct_1.record)((0, superstruct_1.string)(), (0, superstruct_1.string)())),
});
/**
 * Config for fetching object data
 */
exports.SuiObjectDataOptions = (0, superstruct_1.object)({
    /* Whether to fetch the object type, default to be true */
    showType: (0, superstruct_1.optional)((0, superstruct_1.boolean)()),
    /* Whether to fetch the object content, default to be false */
    showContent: (0, superstruct_1.optional)((0, superstruct_1.boolean)()),
    /* Whether to fetch the object content in BCS bytes, default to be false */
    showBcs: (0, superstruct_1.optional)((0, superstruct_1.boolean)()),
    /* Whether to fetch the object owner, default to be false */
    showOwner: (0, superstruct_1.optional)((0, superstruct_1.boolean)()),
    /* Whether to fetch the previous transaction digest, default to be false */
    showPreviousTransaction: (0, superstruct_1.optional)((0, superstruct_1.boolean)()),
    /* Whether to fetch the storage rebate, default to be false */
    showStorageRebate: (0, superstruct_1.optional)((0, superstruct_1.boolean)()),
    /* Whether to fetch the display metadata, default to be false */
    showDisplay: (0, superstruct_1.optional)((0, superstruct_1.boolean)()),
});
exports.ObjectStatus = (0, superstruct_1.union)([(0, superstruct_1.literal)('Exists'), (0, superstruct_1.literal)('NotExists'), (0, superstruct_1.literal)('Deleted')]);
exports.GetOwnedObjectsResponse = (0, superstruct_1.array)(exports.SuiObjectInfo);
exports.SuiObjectResponseError = (0, superstruct_1.object)({
    tag: (0, superstruct_1.string)(),
    object_id: (0, superstruct_1.optional)(common_1.ObjectId),
    version: (0, superstruct_1.optional)(common_1.SequenceNumber),
    digest: (0, superstruct_1.optional)(exports.ObjectDigest),
});
exports.SuiObjectResponse = (0, superstruct_1.object)({
    data: (0, superstruct_1.optional)(exports.SuiObjectData),
    error: (0, superstruct_1.optional)(exports.SuiObjectResponseError),
});
/* -------------------------------------------------------------------------- */
/*                              Helper functions                              */
/* -------------------------------------------------------------------------- */
/* -------------------------- SuiObjectResponse ------------------------- */
function getSuiObjectData(resp) {
    return resp.data;
}
exports.getSuiObjectData = getSuiObjectData;
function getObjectDeletedResponse(resp) {
    if (resp.error && 'object_id' in resp.error && 'version' in resp.error && 'digest' in resp.error) {
        const error = resp.error;
        return {
            objectId: error.object_id,
            version: error.version,
            digest: error.digest,
        };
    }
    return undefined;
}
exports.getObjectDeletedResponse = getObjectDeletedResponse;
function getObjectNotExistsResponse(resp) {
    if (resp.error && 'object_id' in resp.error && !('version' in resp.error) && !('digest' in resp.error)) {
        return resp.error.object_id;
    }
    return undefined;
}
exports.getObjectNotExistsResponse = getObjectNotExistsResponse;
function getObjectReference(resp) {
    if ('reference' in resp) {
        return resp.reference;
    }
    const exists = getSuiObjectData(resp);
    if (exists) {
        return {
            objectId: exists.objectId,
            version: exists.version,
            digest: exists.digest,
        };
    }
    return getObjectDeletedResponse(resp);
}
exports.getObjectReference = getObjectReference;
/* ------------------------------ SuiObjectRef ------------------------------ */
function getObjectId(data) {
    var _a, _b;
    if ('objectId' in data) {
        return data.objectId;
    }
    return (_b = (_a = getObjectReference(data)) === null || _a === void 0 ? void 0 : _a.objectId) !== null && _b !== void 0 ? _b : getObjectNotExistsResponse(data);
}
exports.getObjectId = getObjectId;
function getObjectVersion(data) {
    var _a;
    if ('version' in data) {
        return data.version;
    }
    return (_a = getObjectReference(data)) === null || _a === void 0 ? void 0 : _a.version;
}
exports.getObjectVersion = getObjectVersion;
/* -------------------------------- SuiObject ------------------------------- */
function isSuiObjectResponse(resp) {
    return resp.data !== undefined;
}
exports.isSuiObjectResponse = isSuiObjectResponse;
/**
 * Deriving the object type from the object response
 * @returns 'package' if the object is a package, move object type(e.g., 0x2::coin::Coin<0x2::sui::SUI>)
 * if the object is a move object
 */
function getObjectType(resp) {
    var _a;
    const data = isSuiObjectResponse(resp) ? resp.data : resp;
    if (!(data === null || data === void 0 ? void 0 : data.type) && 'data' in resp) {
        if (((_a = data === null || data === void 0 ? void 0 : data.content) === null || _a === void 0 ? void 0 : _a.dataType) === 'package') {
            return 'package';
        }
        return getMoveObjectType(resp);
    }
    return data === null || data === void 0 ? void 0 : data.type;
}
exports.getObjectType = getObjectType;
function getObjectPreviousTransactionDigest(resp) {
    var _a;
    return (_a = getSuiObjectData(resp)) === null || _a === void 0 ? void 0 : _a.previousTransaction;
}
exports.getObjectPreviousTransactionDigest = getObjectPreviousTransactionDigest;
function getObjectOwner(resp) {
    var _a;
    if ((0, superstruct_1.is)(resp, common_1.ObjectOwner)) {
        return resp;
    }
    return (_a = getSuiObjectData(resp)) === null || _a === void 0 ? void 0 : _a.owner;
}
exports.getObjectOwner = getObjectOwner;
function getObjectDisplay(resp) {
    var _a;
    return (_a = getSuiObjectData(resp)) === null || _a === void 0 ? void 0 : _a.display;
}
exports.getObjectDisplay = getObjectDisplay;
function getSharedObjectInitialVersion(resp) {
    const owner = getObjectOwner(resp);
    if (typeof owner === 'object' && 'Shared' in owner) {
        return owner.Shared.initial_shared_version;
    }
    else {
        return undefined;
    }
}
exports.getSharedObjectInitialVersion = getSharedObjectInitialVersion;
function isSharedObject(resp) {
    const owner = getObjectOwner(resp);
    return typeof owner === 'object' && 'Shared' in owner;
}
exports.isSharedObject = isSharedObject;
function isImmutableObject(resp) {
    const owner = getObjectOwner(resp);
    return owner === 'Immutable';
}
exports.isImmutableObject = isImmutableObject;
function getMoveObjectType(resp) {
    var _a;
    return (_a = getMoveObject(resp)) === null || _a === void 0 ? void 0 : _a.type;
}
exports.getMoveObjectType = getMoveObjectType;
function getObjectFields(resp) {
    var _a;
    if ('fields' in resp) {
        return resp.fields;
    }
    return (_a = getMoveObject(resp)) === null || _a === void 0 ? void 0 : _a.fields;
}
exports.getObjectFields = getObjectFields;
function isSuiObjectDataWithContent(data) {
    return data.content !== undefined;
}
function getMoveObject(data) {
    const suiObject = 'data' in data ? getSuiObjectData(data) : data;
    if (!suiObject || !isSuiObjectDataWithContent(suiObject) || suiObject.content.dataType !== 'moveObject') {
        return undefined;
    }
    return suiObject.content;
}
exports.getMoveObject = getMoveObject;
function hasPublicTransfer(data) {
    var _a, _b;
    return (_b = (_a = getMoveObject(data)) === null || _a === void 0 ? void 0 : _a.hasPublicTransfer) !== null && _b !== void 0 ? _b : false;
}
exports.hasPublicTransfer = hasPublicTransfer;
function getMovePackageContent(data) {
    var _a;
    if ('disassembled' in data) {
        return data.disassembled;
    }
    const suiObject = getSuiObjectData(data);
    if (((_a = suiObject === null || suiObject === void 0 ? void 0 : suiObject.content) === null || _a === void 0 ? void 0 : _a.dataType) !== 'package') {
        return undefined;
    }
    return suiObject.content.disassembled;
}
exports.getMovePackageContent = getMovePackageContent;
exports.CheckpointedObjectId = (0, superstruct_1.object)({
    objectId: common_1.ObjectId,
    atCheckpoint: (0, superstruct_1.optional)((0, superstruct_1.number)()),
});
exports.PaginatedObjectsResponse = (0, superstruct_1.object)({
    data: (0, superstruct_1.array)(exports.SuiObjectResponse),
    nextCursor: (0, superstruct_1.optional)(exports.CheckpointedObjectId),
    hasNextPage: (0, superstruct_1.boolean)(),
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib2JqZWN0cy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9saWIvbXlzdGVubGFiL3R5cGVzL29iamVjdHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsNkNBY3FCO0FBQ3JCLHFDQUFvRjtBQUd2RSxRQUFBLFVBQVUsR0FBRyxJQUFBLG1CQUFLLEVBQUMsQ0FBQyxJQUFBLG9CQUFNLEdBQUUsRUFBRSxJQUFBLHFCQUFPLEVBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBR25ELFFBQUEsWUFBWSxHQUFHLElBQUEsb0JBQU0sRUFBQztJQUNqQyxtREFBbUQ7SUFDbkQsTUFBTSxFQUFFLDBCQUFpQjtJQUN6QixvREFBb0Q7SUFDcEQsUUFBUSxFQUFFLElBQUEsb0JBQU0sR0FBRTtJQUNsQixxQkFBcUI7SUFDckIsT0FBTyxFQUFFLElBQUEsbUJBQUssRUFBQyxDQUFDLElBQUEsb0JBQU0sR0FBRSxFQUFFLElBQUEsb0JBQU0sR0FBRSxDQUFDLENBQUM7Q0FDckMsQ0FBQyxDQUFDO0FBR1UsUUFBQSxVQUFVLEdBQUcsSUFBQSxvQkFBTSxFQUFDO0lBQy9CLE9BQU8sRUFBRSxJQUFBLG1CQUFLLEVBQUMsb0JBQVksQ0FBQztJQUM1Qix5QkFBeUI7SUFDekIsS0FBSyxFQUFFLElBQUEsb0JBQU0sR0FBRTtJQUNmLEtBQUssRUFBRSxJQUFBLG9CQUFNLEdBQUU7SUFDZixNQUFNLEVBQUUsSUFBQSxvQkFBTSxHQUFFO0NBQ2pCLENBQUMsQ0FBQztBQUdVLFFBQUEsYUFBYSxHQUFHLElBQUEsb0JBQU0sRUFDakMsb0JBQVksRUFDWixJQUFBLG9CQUFNLEVBQUM7SUFDTCxJQUFJLEVBQUUsSUFBQSxvQkFBTSxHQUFFO0lBQ2QsS0FBSyxFQUFFLG9CQUFXO0lBQ2xCLG1CQUFtQixFQUFFLDBCQUFpQjtDQUN2QyxDQUFDLENBQ0gsQ0FBQztBQUdXLFFBQUEsbUJBQW1CLEdBQUcsSUFBQSxvQkFBTSxFQUFD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QUFNLEdBQUUsQ0FBQztDQUNqQyxDQUFDLENBQUM7QUFHVSxRQUFBLHdCQUF3QixHQUFHLElBQUEsb0JBQU0sRUFBQztJQUM3QyxJQUFJLEVBQUUsSUFBQSxtQkFBSyxFQUFDLHlCQUFpQixDQUFDO0lBQzlCLFVBQVUsRUFBRSxJQUFBLHNCQUFRLEVBQUMsNEJBQW9CLENBQUM7SUFDMUMsV0FBVyxFQUFFLElBQUEscUJBQU8sR0FBRTtDQUN2QixDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBhbnksXG4gIGFycmF5LFxuICBhc3NpZ24sXG4gIGJvb2xlYW4sXG4gIEluZmVyLFxuICBsaXRlcmFsLFxuICBudW1iZXIsXG4gIG9iamVjdCxcbiAgb3B0aW9uYWwsXG4gIHJlY29yZCxcbiAgc3RyaW5nLFxuICB1bmlvbixcbiAgaXMsXG59IGZyb20gJ3N1cGVyc3RydWN0JztcbmltcG9ydCB7IE9iamVjdElkLCBPYmplY3RPd25lciwgU2VxdWVuY2VOdW1iZXIsIFRyYW5zYWN0aW9uRGlnZXN0IH0gZnJvbSAnLi9jb21tb24nO1xuaW1wb3J0IHsgT3duZWRPYmplY3RSZWYgfSBmcm9tICcuL3RyYW5zYWN0aW9ucyc7XG5cbmV4cG9ydCBjb25zdCBPYmplY3RUeXBlID0gdW5pb24oW3N0cmluZygpLCBsaXRlcmFsKCdwYWNrYWdlJyldKTtcbmV4cG9ydCB0eXBlIE9iamVjdFR5cGUgPSBJbmZlcjx0eXBlb2YgT2JqZWN0VHlwZT47XG5cbmV4cG9ydCBjb25zdCBTdWlPYmplY3RSZWYgPSBvYmplY3Qoe1xuICAvKiogQmFzZTY0IHN0cmluZyByZXByZXNlbnRpbmcgdGhlIG9iamVjdCBkaWdlc3QgKi9cbiAgZGlnZXN0OiBUcmFuc2FjdGlvbkRpZ2VzdCxcbiAgLyoqIEhleCBjb2RlIGFzIHN0cmluZyByZXByZXNlbnRpbmcgdGhlIG9iamVjdCBpZCAqL1xuICBvYmplY3RJZDogc3RyaW5nKCksXG4gIC8qKiBPYmplY3QgdmVyc2lvbiAqL1xuICB2ZXJzaW9uOiB1bmlvbihbbnVtYmVyKCksIHN0cmluZygpXSksXG59KTtcbmV4cG9ydCB0eXBlIFN1aU9iamVjdFJlZiA9IEluZmVyPHR5cGVvZiBTdWlPYmplY3RSZWY+O1xuXG5leHBvcnQgY29uc3QgU3VpR2FzRGF0YSA9IG9iamVjdCh7XG4gIHBheW1lbnQ6IGFycmF5KFN1aU9iamVjdFJlZiksXG4gIC8qKiBHYXMgT2JqZWN0J3Mgb3duZXIgKi9cbiAgb3duZXI6IHN0cmluZygpLFxuICBwcmljZTogbnVtYmVyKCksXG4gIGJ1ZGdldDogbnVtYmVyKCksXG59KTtcbmV4cG9ydCB0eXBlIFN1aUdhc0RhdGEgPSBJbmZlcjx0eXBlb2YgU3VpR2FzRGF0YT47XG5cbmV4cG9ydCBjb25zdCBTdWlPYmplY3RJbmZvID0gYXNzaWduKFxuICBTdWlPYmplY3RSZWYsXG4gIG9iamVjdCh7XG4gICAgdHlwZTogc3RyaW5nKCksXG4gICAgb3duZXI6IE9iamVjdE93bmVyLFxuICAgIHByZXZpb3VzVHJhbnNhY3Rpb246IFRyYW5zYWN0aW9uRGlnZXN0LFxuICB9KVxuKTtcbmV4cG9ydCB0eXBlIFN1aU9iamVjdEluZm8gPSBJbmZlcjx0eXBlb2YgU3VpT2JqZWN0SW5mbz47XG5cbmV4cG9ydCBjb25zdCBPYmplY3RDb250ZW50RmllbGRzID0gcmVjb3JkKHN0cmluZygpLCBhbnkoKSk7XG5leHBvcnQgdHlwZSBPYmplY3RDb250ZW50RmllbGRzID0gSW5mZXI8dHlwZW9mIE9iamVjdENvbnRlbnRGaWVsZHM+O1xuXG5leHBvcnQgY29uc3QgTW92ZVBhY2thZ2VDb250ZW50ID0gcmVjb3JkKHN0cmluZygpLCBzdHJpbmcoKSk7XG5leHBvcnQgdHlwZSBNb3ZlUGFja2FnZUNvbnRlbnQgPSBJbmZlcjx0eXBlb2YgTW92ZVBhY2thZ2VDb250ZW50PjtcblxuZXhwb3J0IGNvbnN0IFN1aU1vdmVPYmplY3QgPSBvYmplY3Qoe1xuICAvKiogTW92ZSB0eXBlIChlLmcuLCBcIjB4Mjo6Y29pbjo6Q29pbjwweDI6OnN1aTo6U1VJPlwiKSAqL1xuICB0eXBlOiBzdHJpbmcoKSxcbiAgLyoqIEZpZWxkcyBhbmQgdmFsdWVzIHN0b3JlZCBpbnNpZGUgdGhlIE1vdmUgb2JqZWN0ICovXG4gIGZpZWxkczogT2JqZWN0Q29udGVudEZpZWxkcyxcbiAgaGFzUHVibGljVHJhbnNmZXI6IGJvb2xlYW4oKSxcbn0pO1xuZXhwb3J0IHR5cGUgU3VpTW92ZU9iamVjdCA9IEluZmVyPHR5cGVvZiBTdWlNb3ZlT2JqZWN0PjtcblxuZXhwb3J0IGNvbnN0IFN1aU1vdmVQYWNrYWdlID0gb2JqZWN0KHtcbiAgLyoqIEEgbWFwcGluZyBmcm9tIG1vZHVsZSBuYW1lIHRvIGRpc2Fzc2VtYmxlZCBNb3ZlIGJ5dGVjb2RlICovXG4gIGRpc2Fzc2VtYmxlZDogTW92ZVBhY2thZ2VDb250ZW50LFxufSk7XG5leHBvcnQgdHlwZSBTdWlNb3ZlUGFja2FnZSA9IEluZmVyPHR5cGVvZiBTdWlNb3ZlUGFja2FnZT47XG5cbmV4cG9ydCBjb25zdCBTdWlQYXJzZWREYXRhID0gdW5pb24oW1xuICBhc3NpZ24oU3VpTW92ZU9iamVjdCwgb2JqZWN0KHsgZGF0YVR5cGU6IGxpdGVyYWwoJ21vdmVPYmplY3QnKSB9KSksXG4gIGFzc2lnbihTdWlNb3ZlUGFja2FnZSwgb2JqZWN0KHsgZGF0YVR5cGU6IGxpdGVyYWwoJ3BhY2thZ2UnKSB9KSksXG5dKTtcbmV4cG9ydCB0eXBlIFN1aVBhcnNlZERhdGEgPSBJbmZlcjx0eXBlb2YgU3VpUGFyc2VkRGF0YT47XG5cbmV4cG9ydCBjb25zdCBTdWlSYXdNb3ZlT2JqZWN0ID0gb2JqZWN0KHtcbiAgLyoqIE1vdmUgdHlwZSAoZS5nLiwgXCIweDI6OmNvaW46OkNvaW48MHgyOjpzdWk6OlNVST5cIikgKi9cbiAgdHlwZTogc3RyaW5nKCksXG4gIGhhc1B1YmxpY1RyYW5zZmVyOiBib29sZWFuKCksXG4gIHZlcnNpb246IFNlcXVlbmNlTnVtYmVyLFxuICBiY3NCeXRlczogYXJyYXkobnVtYmVyKCkpLFxufSk7XG5leHBvcnQgdHlwZSBTdWlSYXdNb3ZlT2JqZWN0ID0gSW5mZXI8dHlwZW9mIFN1aVJhd01vdmVPYmplY3Q+O1xuXG5leHBvcnQgY29uc3QgU3VpUmF3TW92ZVBhY2thZ2UgPSBvYmplY3Qoe1xuICBpZDogT2JqZWN0SWQsXG4gIC8qKiBBIG1hcHBpbmcgZnJvbSBtb2R1bGUgbmFtZSB0byBNb3ZlIGJ5dGVjb2RlIGVub2NkZWQgaW4gYmFzZTY0Ki9cbiAgbW9kdWxlTWFwOiByZWNvcmQoc3RyaW5nKCksIHN0cmluZygpKSxcbn0pO1xuZXhwb3J0IHR5cGUgU3VpUmF3TW92ZVBhY2thZ2UgPSBJbmZlcjx0eXBlb2YgU3VpUmF3TW92ZVBhY2thZ2U+O1xuXG4vLyBUT0RPKGNocmlzKTogY29uc29saWRhdGUgU3VpUmF3UGFyc2VkRGF0YSBhbmQgU3VpUmF3T2JqZWN0IHVzaW5nIGdlbmVyaWNzXG5leHBvcnQgY29uc3QgU3VpUmF3RGF0YSA9IHVuaW9uKFtcbiAgYXNzaWduKFN1aU1vdmVPYmplY3QsIG9iamVjdCh7IGRhdGFUeXBlOiBsaXRlcmFsKCdtb3ZlT2JqZWN0JykgfSkpLFxuICBhc3NpZ24oU3VpUmF3TW92ZVBhY2thZ2UsIG9iamVjdCh7IGRhdGFUeXBlOiBsaXRlcmFsKCdwYWNrYWdlJykgfSkpLFxuXSk7XG5leHBvcnQgdHlwZSBTdWlSYXdEYXRhID0gSW5mZXI8dHlwZW9mIFN1aVJhd0RhdGE+O1xuXG5leHBvcnQgY29uc3QgTUlTVF9QRVJfU1VJID0gQmlnSW50KDEwMDAwMDAwMDApO1xuXG5leHBvcnQgY29uc3QgT2JqZWN0RGlnZXN0ID0gc3RyaW5nKCk7XG5leHBvcnQgdHlwZSBPYmplY3REaWdlc3QgPSBJbmZlcjx0eXBlb2YgT2JqZWN0RGlnZXN0PjtcblxuZXhwb3J0IGNvbnN0IFN1aU9iamVjdERhdGEgPSBvYmplY3Qoe1xuICBvYmplY3RJZDogT2JqZWN0SWQsXG4gIHZlcnNpb246IFNlcXVlbmNlTnVtYmVyLFxuICBkaWdlc3Q6IE9iamVjdERpZ2VzdCxcbiAgLyoqXG4gICAqIFR5cGUgb2YgdGhlIG9iamVjdCwgZGVmYXVsdCB0byBiZSB1bmRlZmluZWQgdW5sZXNzIFN1aU9iamVjdERhdGFPcHRpb25zLnNob3dUeXBlIGlzIHNldCB0byB0cnVlXG4gICAqL1xuICB0eXBlOiBvcHRpb25hbChzdHJpbmcoKSksXG4gIC8qKlxuICAgKiBNb3ZlIG9iamVjdCBjb250ZW50IG9yIHBhY2thZ2UgY29udGVudCwgZGVmYXVsdCB0byBiZSB1bmRlZmluZWQgdW5sZXNzIFN1aU9iamVjdERhdGFPcHRpb25zLnNob3dDb250ZW50IGlzIHNldCB0byB0cnVlXG4gICAqL1xuICBjb250ZW50OiBvcHRpb25hbChTdWlQYXJzZWREYXRhKSxcbiAgLyoqXG4gICAqIE1vdmUgb2JqZWN0IGNvbnRlbnQgb3IgcGFja2FnZSBjb250ZW50IGluIEJDUyBieXRlcywgZGVmYXVsdCB0byBiZSB1bmRlZmluZWQgdW5sZXNzIFN1aU9iamVjdERhdGFPcHRpb25zLnNob3dCY3MgaXMgc2V0IHRvIHRydWVcbiAgICovXG4gIGJjczogb3B0aW9uYWwoU3VpUmF3RGF0YSksXG4gIC8qKlxuICAgKiBUaGUgb3duZXIgb2YgdGhpcyBvYmplY3QuIERlZmF1bHQgdG8gYmUgdW5kZWZpbmVkIHVubGVzcyBTdWlPYmplY3REYXRhT3B0aW9ucy5zaG93T3duZXIgaXMgc2V0IHRvIHRydWVcbiAgICovXG4gIG93bmVyOiBvcHRpb25hbChPYmplY3RPd25lciksXG4gIC8qKlxuICAgKiBUaGUgZGlnZXN0IG9mIHRoZSB0cmFuc2FjdGlvbiB0aGF0IGNyZWF0ZWQgb3IgbGFzdCBtdXRhdGVkIHRoaXMgb2JqZWN0LlxuICAgKiBEZWZhdWx0IHRvIGJlIHVuZGVmaW5lZCB1bmxlc3MgU3VpT2JqZWN0RGF0YU9wdGlvbnMuc2hvd1ByZXZpb3VzVHJhbnNhY3Rpb24gaXMgc2V0IHRvIHRydWVcbiAgICovXG4gIHByZXZpb3VzVHJhbnNhY3Rpb246IG9wdGlvbmFsKFRyYW5zYWN0aW9uRGlnZXN0KSxcbiAgLyoqXG4gICAqIFRoZSBhbW91bnQgb2YgU1VJIHdlIHdvdWxkIHJlYmF0ZSBpZiB0aGlzIG9iamVjdCBnZXRzIGRlbGV0ZWQuXG4gICAqIFRoaXMgbnVtYmVyIGlzIHJlLWNhbGN1bGF0ZWQgZWFjaCB0aW1lIHRoZSBvYmplY3QgaXMgbXV0YXRlZCBiYXNlZCBvblxuICAgKiB0aGUgcHJlc2VudCBzdG9yYWdlIGdhcyBwcmljZS5cbiAgICogRGVmYXVsdCB0byBiZSB1bmRlZmluZWQgdW5sZXNzIFN1aU9iamVjdERhdGFPcHRpb25zLnNob3dTdG9yYWdlUmViYXRlIGlzIHNldCB0byB0cnVlXG4gICAqL1xuICBzdG9yYWdlUmViYXRlOiBvcHRpb25hbChudW1iZXIoKSksXG4gIC8qKlxuICAgKiBEaXNwbGF5IG1ldGFkYXRhIGZvciB0aGlzIG9iamVjdCwgZGVmYXVsdCB0byBiZSB1bmRlZmluZWQgdW5sZXNzIFN1aU9iamVjdERhdGFPcHRpb25zLnNob3dEaXNwbGF5IGlzIHNldCB0byB0cnVlXG4gICAqIFRoaXMgY2FuIGFsc28gYmUgTm9uZSBpZiB0aGUgc3RydWN0IHR5cGUgZG9lcyBub3QgaGF2ZSBEaXNwbGF5IGRlZmluZWRcbiAgICogU2VlIG1vcmUgZGV0YWlscyBpbiBodHRwczovL2ZvcnVtcy5zdWkuaW8vdC9uZnQtb2JqZWN0LWRpc3BsYXktcHJvcG9zYWwvNDg3MlxuICAgKi9cbiAgZGlzcGxheTogb3B0aW9uYWwocmVjb3JkKHN0cmluZygpLCBzdHJpbmcoKSkpLFxufSk7XG5leHBvcnQgdHlwZSBTdWlPYmplY3REYXRhID0gSW5mZXI8dHlwZW9mIFN1aU9iamVjdERhdGE+O1xuXG4vKipcbiAqIENvbmZpZyBmb3IgZmV0Y2hpbmcgb2JqZWN0IGRhdGFcbiAqL1xuZXhwb3J0IGNvbnN0IFN1aU9iamVjdERhdGFPcHRpb25zID0gb2JqZWN0KHtcbiAgLyogV2hldGhlciB0byBmZXRjaCB0aGUgb2JqZWN0IHR5cGUsIGRlZmF1bHQgdG8gYmUgdHJ1ZSAqL1xuICBzaG93VHlwZTogb3B0aW9uYWwoYm9vbGVhbigpKSxcbiAgLyogV2hldGhlciB0byBmZXRjaCB0aGUgb2JqZWN0IGNvbnRlbnQsIGRlZmF1bHQgdG8gYmUgZmFsc2UgKi9cbiAgc2hvd0NvbnRlbnQ6IG9wdGlvbmFsKGJvb2xlYW4oKSksXG4gIC8qIFdoZXRoZXIgdG8gZmV0Y2ggdGhlIG9iamVjdCBjb250ZW50IGluIEJDUyBieXRlcywgZGVmYXVsdCB0byBiZSBmYWxzZSAqL1xuICBzaG93QmNzOiBvcHRpb25hbChib29sZWFuKCkpLFxuICAvKiBXaGV0aGVyIHRvIGZldGNoIHRoZSBvYmplY3Qgb3duZXIsIGRlZmF1bHQgdG8gYmUgZmFsc2UgKi9cbiAgc2hvd093bmVyOiBvcHRpb25hbChib29sZWFuKCkpLFxuICAvKiBXaGV0aGVyIHRvIGZldGNoIHRoZSBwcmV2aW91cyB0cmFuc2FjdGlvbiBkaWdlc3QsIGRlZmF1bHQgdG8gYmUgZmFsc2UgKi9cbiAgc2hvd1ByZXZpb3VzVHJhbnNhY3Rpb246IG9wdGlvbmFsKGJvb2xlYW4oKSksXG4gIC8qIFdoZXRoZXIgdG8gZmV0Y2ggdGhlIHN0b3JhZ2UgcmViYXRlLCBkZWZhdWx0IHRvIGJlIGZhbHNlICovXG4gIHNob3dTdG9yYWdlUmViYXRlOiBvcHRpb25hbChib29sZWFuKCkpLFxuICAvKiBXaGV0aGVyIHRvIGZldGNoIHRoZSBkaXNwbGF5IG1ldGFkYXRhLCBkZWZhdWx0IHRvIGJlIGZhbHNlICovXG4gIHNob3dEaXNwbGF5OiBvcHRpb25hbChib29sZWFuKCkpLFxufSk7XG5leHBvcnQgdHlwZSBTdWlPYmplY3REYXRhT3B0aW9ucyA9IEluZmVyPHR5cGVvZiBTdWlPYmplY3REYXRhT3B0aW9ucz47XG5cbmV4cG9ydCBjb25zdCBPYmplY3RTdGF0dXMgPSB1bmlvbihbbGl0ZXJhbCgnRXhpc3RzJyksIGxpdGVyYWwoJ05vdEV4aXN0cycpLCBsaXRlcmFsKCdEZWxldGVkJyldKTtcbmV4cG9ydCB0eXBlIE9iamVjdFN0YXR1cyA9IEluZmVyPHR5cGVvZiBPYmplY3RTdGF0dXM+O1xuXG5leHBvcnQgY29uc3QgR2V0T3duZWRPYmplY3RzUmVzcG9uc2UgPSBhcnJheShTdWlPYmplY3RJbmZvKTtcbmV4cG9ydCB0eXBlIEdldE93bmVkT2JqZWN0c1Jlc3BvbnNlID0gSW5mZXI8dHlwZW9mIEdldE93bmVkT2JqZWN0c1Jlc3BvbnNlPjtcblxuZXhwb3J0IGNvbnN0IFN1aU9iamVjdFJlc3BvbnNlRXJyb3IgPSBvYmplY3Qoe1xuICB0YWc6IHN0cmluZygpLFxuICBvYmplY3RfaWQ6IG9wdGlvbmFsKE9iamVjdElkKSxcbiAgdmVyc2lvbjogb3B0aW9uYWwoU2VxdWVuY2VOdW1iZXIpLFxuICBkaWdlc3Q6IG9wdGlvbmFsKE9iamVjdERpZ2VzdCksXG59KTtcbmV4cG9ydCB0eXBlIFN1aU9iamVjdFJlc3BvbnNlRXJyb3IgPSBJbmZlcjx0eXBlb2YgU3VpT2JqZWN0UmVzcG9uc2VFcnJvcj47XG5cbmV4cG9ydCBjb25zdCBTdWlPYmplY3RSZXNwb25zZSA9IG9iamVjdCh7XG4gIGRhdGE6IG9wdGlvbmFsKFN1aU9iamVjdERhdGEpLFxuICBlcnJvcjogb3B0aW9uYWwoU3VpT2JqZWN0UmVzcG9uc2VFcnJvciksXG59KTtcbmV4cG9ydCB0eXBlIFN1aU9iamVjdFJlc3BvbnNlID0gSW5mZXI8dHlwZW9mIFN1aU9iamVjdFJlc3BvbnNlPjtcblxuZXhwb3J0IHR5cGUgT3JkZXIgPSAnYXNjZW5kaW5nJyB8ICdkZXNjZW5kaW5nJztcblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSGVscGVyIGZ1bmN0aW9ucyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBTdWlPYmplY3RSZXNwb25zZSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRTdWlPYmplY3REYXRhKHJlc3A6IFN1aU9iamVjdFJlc3BvbnNlKTogU3VpT2JqZWN0RGF0YSB8IHVuZGVmaW5lZCB7XG4gIHJldHVybiByZXNwLmRhdGE7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRPYmplY3REZWxldGVkUmVzcG9uc2UocmVzcDogU3VpT2JqZWN0UmVzcG9uc2UpOiBTdWlPYmplY3RSZWYgfCB1bmRlZmluZWQge1xuICBpZiAocmVzcC5lcnJvciAmJiAnb2JqZWN0X2lkJyBpbiByZXNwLmVycm9yICYmICd2ZXJzaW9uJyBpbiByZXNwLmVycm9yICYmICdkaWdlc3QnIGluIHJlc3AuZXJyb3IpIHtcbiAgICBjb25zdCBlcnJvciA9IHJlc3AuZXJyb3IgYXMgU3VpT2JqZWN0UmVzcG9uc2VFcnJvcjtcbiAgICByZXR1cm4ge1xuICAgICAgb2JqZWN0SWQ6IGVycm9yLm9iamVjdF9pZCxcbiAgICAgIHZlcnNpb246IGVycm9yLnZlcnNpb24sXG4gICAgICBkaWdlc3Q6IGVycm9yLmRpZ2VzdCxcbiAgICB9IGFzIFN1aU9iamVjdFJlZjtcbiAgfVxuXG4gIHJldHVybiB1bmRlZmluZWQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRPYmplY3ROb3RFeGlzdHNSZXNwb25zZShyZXNwOiBTdWlPYmplY3RSZXNwb25zZSk6IE9iamVjdElkIHwgdW5kZWZpbmVkIHtcbiAgaWYgKHJlc3AuZXJyb3IgJiYgJ29iamVjdF9pZCcgaW4gcmVzcC5lcnJvciAmJiAhKCd2ZXJzaW9uJyBpbiByZXNwLmVycm9yKSAmJiAhKCdkaWdlc3QnIGluIHJlc3AuZXJyb3IpKSB7XG4gICAgcmV0dXJuIChyZXNwLmVycm9yIGFzIFN1aU9iamVjdFJlc3BvbnNlRXJyb3IpLm9iamVjdF9pZCBhcyBPYmplY3RJZDtcbiAgfVxuXG4gIHJldHVybiB1bmRlZmluZWQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRPYmplY3RSZWZlcmVuY2UocmVzcDogU3VpT2JqZWN0UmVzcG9uc2UgfCBPd25lZE9iamVjdFJlZik6IFN1aU9iamVjdFJlZiB8IHVuZGVmaW5lZCB7XG4gIGlmICgncmVmZXJlbmNlJyBpbiByZXNwKSB7XG4gICAgcmV0dXJuIHJlc3AucmVmZXJlbmNlO1xuICB9XG4gIGNvbnN0IGV4aXN0cyA9IGdldFN1aU9iamVjdERhdGEocmVzcCk7XG4gIGlmIChleGlzdHMpIHtcbiAgICByZXR1cm4ge1xuICAgICAgb2JqZWN0SWQ6IGV4aXN0cy5vYmplY3RJZCxcbiAgICAgIHZlcnNpb246IGV4aXN0cy52ZXJzaW9uLFxuICAgICAgZGlnZXN0OiBleGlzdHMuZGlnZXN0LFxuICAgIH07XG4gIH1cbiAgcmV0dXJuIGdldE9iamVjdERlbGV0ZWRSZXNwb25zZShyZXNwKTtcbn1cblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIFN1aU9iamVjdFJlZiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuZXhwb3J0IGZ1bmN0aW9uIGdldE9iamVjdElkKGRhdGE6IFN1aU9iamVjdFJlc3BvbnNlIHwgU3VpT2JqZWN0UmVmIHwgT3duZWRPYmplY3RSZWYpOiBPYmplY3RJZCB7XG4gIGlmICgnb2JqZWN0SWQnIGluIGRhdGEpIHtcbiAgICByZXR1cm4gZGF0YS5vYmplY3RJZDtcbiAgfVxuICByZXR1cm4gZ2V0T2JqZWN0UmVmZXJlbmNlKGRhdGEpPy5vYmplY3RJZCA/PyBnZXRPYmplY3ROb3RFeGlzdHNSZXNwb25zZShkYXRhIGFzIFN1aU9iamVjdFJlc3BvbnNlKSE7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRPYmplY3RWZXJzaW9uKGRhdGE6IFN1aU9iamVjdFJlc3BvbnNlIHwgU3VpT2JqZWN0UmVmIHwgU3VpT2JqZWN0RGF0YSk6IHN0cmluZyB8IG51bWJlciB8IHVuZGVmaW5lZCB7XG4gIGlmICgndmVyc2lvbicgaW4gZGF0YSkge1xuICAgIHJldHVybiBkYXRhLnZlcnNpb247XG4gIH1cbiAgcmV0dXJuIGdldE9iamVjdFJlZmVyZW5jZShkYXRhKT8udmVyc2lvbjtcbn1cblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gU3VpT2JqZWN0IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuZXhwb3J0IGZ1bmN0aW9uIGlzU3VpT2JqZWN0UmVzcG9uc2UocmVzcDogU3VpT2JqZWN0UmVzcG9uc2UgfCBTdWlPYmplY3REYXRhKTogcmVzcCBpcyBTdWlPYmplY3RSZXNwb25zZSB7XG4gIHJldHVybiAocmVzcCBhcyBTdWlPYmplY3RSZXNwb25zZSkuZGF0YSAhPT0gdW5kZWZpbmVkO1xufVxuXG4vKipcbiAqIERlcml2aW5nIHRoZSBvYmplY3QgdHlwZSBmcm9tIHRoZSBvYmplY3QgcmVzcG9uc2VcbiAqIEByZXR1cm5zICdwYWNrYWdlJyBpZiB0aGUgb2JqZWN0IGlzIGEgcGFja2FnZSwgbW92ZSBvYmplY3QgdHlwZShlLmcuLCAweDI6OmNvaW46OkNvaW48MHgyOjpzdWk6OlNVST4pXG4gKiBpZiB0aGUgb2JqZWN0IGlzIGEgbW92ZSBvYmplY3RcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldE9iamVjdFR5cGUocmVzcDogU3VpT2JqZWN0UmVzcG9uc2UgfCBTdWlPYmplY3REYXRhKTogT2JqZWN0VHlwZSB8IHVuZGVmaW5lZCB7XG4gIGNvbnN0IGRhdGEgPSBpc1N1aU9iamVjdFJlc3BvbnNlKHJlc3ApID8gcmVzcC5kYXRhIDogcmVzcDtcblxuICBpZiAoIWRhdGE/LnR5cGUgJiYgJ2RhdGEnIGluIHJlc3ApIHtcbiAgICBpZiAoZGF0YT8uY29udGVudD8uZGF0YVR5cGUgPT09ICdwYWNrYWdlJykge1xuICAgICAgcmV0dXJuICdwYWNrYWdlJztcbiAgICB9XG4gICAgcmV0dXJuIGdldE1vdmVPYmplY3RUeXBlKHJlc3ApO1xuICB9XG4gIHJldHVybiBkYXRhPy50eXBlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0T2JqZWN0UHJldmlvdXNUcmFuc2FjdGlvbkRpZ2VzdChyZXNwOiBTdWlPYmplY3RSZXNwb25zZSk6IFRyYW5zYWN0aW9uRGlnZXN0IHwgdW5kZWZpbmVkIHtcbiAgcmV0dXJuIGdldFN1aU9iamVjdERhdGEocmVzcCk/LnByZXZpb3VzVHJhbnNhY3Rpb247XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRPYmplY3RPd25lcihyZXNwOiBTdWlPYmplY3RSZXNwb25zZSB8IE9iamVjdE93bmVyKTogT2JqZWN0T3duZXIgfCB1bmRlZmluZWQge1xuICBpZiAoaXMocmVzcCwgT2JqZWN0T3duZXIpKSB7XG4gICAgcmV0dXJuIHJlc3A7XG4gIH1cbiAgcmV0dXJuIGdldFN1aU9iamVjdERhdGEocmVzcCk/Lm93bmVyO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0T2JqZWN0RGlzcGxheShyZXNwOiBTdWlPYmplY3RSZXNwb25zZSk6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfCB1bmRlZmluZWQge1xuICByZXR1cm4gZ2V0U3VpT2JqZWN0RGF0YShyZXNwKT8uZGlzcGxheTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFNoYXJlZE9iamVjdEluaXRpYWxWZXJzaW9uKHJlc3A6IFN1aU9iamVjdFJlc3BvbnNlIHwgT2JqZWN0T3duZXIpOiBudW1iZXIgfCB1bmRlZmluZWQge1xuICBjb25zdCBvd25lciA9IGdldE9iamVjdE93bmVyKHJlc3ApO1xuICBpZiAodHlwZW9mIG93bmVyID09PSAnb2JqZWN0JyAmJiAnU2hhcmVkJyBpbiBvd25lcikge1xuICAgIHJldHVybiBvd25lci5TaGFyZWQuaW5pdGlhbF9zaGFyZWRfdmVyc2lvbjtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1NoYXJlZE9iamVjdChyZXNwOiBTdWlPYmplY3RSZXNwb25zZSB8IE9iamVjdE93bmVyKTogYm9vbGVhbiB7XG4gIGNvbnN0IG93bmVyID0gZ2V0T2JqZWN0T3duZXIocmVzcCk7XG4gIHJldHVybiB0eXBlb2Ygb3duZXIgPT09ICdvYmplY3QnICYmICdTaGFyZWQnIGluIG93bmVyO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNJbW11dGFibGVPYmplY3QocmVzcDogU3VpT2JqZWN0UmVzcG9uc2UgfCBPYmplY3RPd25lcik6IGJvb2xlYW4ge1xuICBjb25zdCBvd25lciA9IGdldE9iamVjdE93bmVyKHJlc3ApO1xuICByZXR1cm4gb3duZXIgPT09ICdJbW11dGFibGUnO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0TW92ZU9iamVjdFR5cGUocmVzcDogU3VpT2JqZWN0UmVzcG9uc2UpOiBzdHJpbmcgfCB1bmRlZmluZWQge1xuICByZXR1cm4gZ2V0TW92ZU9iamVjdChyZXNwKT8udHlwZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldE9iamVjdEZpZWxkcyhcbiAgcmVzcDogU3VpT2JqZWN0UmVzcG9uc2UgfCBTdWlNb3ZlT2JqZWN0IHwgU3VpT2JqZWN0RGF0YVxuKTogT2JqZWN0Q29udGVudEZpZWxkcyB8IHVuZGVmaW5lZCB7XG4gIGlmICgnZmllbGRzJyBpbiByZXNwKSB7XG4gICAgcmV0dXJuIHJlc3AuZmllbGRzO1xuICB9XG4gIHJldHVybiBnZXRNb3ZlT2JqZWN0KHJlc3ApPy5maWVsZHM7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU3VpT2JqZWN0RGF0YVdpdGhDb250ZW50IGV4dGVuZHMgU3VpT2JqZWN0RGF0YSB7XG4gIGNvbnRlbnQ6IFN1aVBhcnNlZERhdGE7XG59XG5cbmZ1bmN0aW9uIGlzU3VpT2JqZWN0RGF0YVdpdGhDb250ZW50KGRhdGE6IFN1aU9iamVjdERhdGEpOiBkYXRhIGlzIFN1aU9iamVjdERhdGFXaXRoQ29udGVudCB7XG4gIHJldHVybiBkYXRhLmNvbnRlbnQgIT09IHVuZGVmaW5lZDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldE1vdmVPYmplY3QoZGF0YTogU3VpT2JqZWN0UmVzcG9uc2UgfCBTdWlPYmplY3REYXRhKTogU3VpTW92ZU9iamVjdCB8IHVuZGVmaW5lZCB7XG4gIGNvbnN0IHN1aU9iamVjdCA9ICdkYXRhJyBpbiBkYXRhID8gZ2V0U3VpT2JqZWN0RGF0YShkYXRhKSA6IChkYXRhIGFzIFN1aU9iamVjdERhdGEpO1xuXG4gIGlmICghc3VpT2JqZWN0IHx8ICFpc1N1aU9iamVjdERhdGFXaXRoQ29udGVudChzdWlPYmplY3QpIHx8IHN1aU9iamVjdC5jb250ZW50LmRhdGFUeXBlICE9PSAnbW92ZU9iamVjdCcpIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG5cbiAgcmV0dXJuIHN1aU9iamVjdC5jb250ZW50IGFzIFN1aU1vdmVPYmplY3Q7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBoYXNQdWJsaWNUcmFuc2ZlcihkYXRhOiBTdWlPYmplY3RSZXNwb25zZSB8IFN1aU9iamVjdERhdGEpOiBib29sZWFuIHtcbiAgcmV0dXJuIGdldE1vdmVPYmplY3QoZGF0YSk/Lmhhc1B1YmxpY1RyYW5zZmVyID8/IGZhbHNlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0TW92ZVBhY2thZ2VDb250ZW50KGRhdGE6IFN1aU9iamVjdFJlc3BvbnNlIHwgU3VpTW92ZVBhY2thZ2UpOiBNb3ZlUGFja2FnZUNvbnRlbnQgfCB1bmRlZmluZWQge1xuICBpZiAoJ2Rpc2Fzc2VtYmxlZCcgaW4gZGF0YSkge1xuICAgIHJldHVybiBkYXRhLmRpc2Fzc2VtYmxlZDtcbiAgfVxuICBjb25zdCBzdWlPYmplY3QgPSBnZXRTdWlPYmplY3REYXRhKGRhdGEpO1xuICBpZiAoc3VpT2JqZWN0Py5jb250ZW50Py5kYXRhVHlwZSAhPT0gJ3BhY2thZ2UnKSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuICByZXR1cm4gKHN1aU9iamVjdC5jb250ZW50IGFzIFN1aU1vdmVQYWNrYWdlKS5kaXNhc3NlbWJsZWQ7XG59XG5cbmV4cG9ydCBjb25zdCBDaGVja3BvaW50ZWRPYmplY3RJZCA9IG9iamVjdCh7XG4gIG9iamVjdElkOiBPYmplY3RJZCxcbiAgYXRDaGVja3BvaW50OiBvcHRpb25hbChudW1iZXIoKSksXG59KTtcbmV4cG9ydCB0eXBlIENoZWNrcG9pbnRlZE9iamVjdElkID0gSW5mZXI8dHlwZW9mIENoZWNrcG9pbnRlZE9iamVjdElkPjtcblxuZXhwb3J0IGNvbnN0IFBhZ2luYXRlZE9iamVjdHNSZXNwb25zZSA9IG9iamVjdCh7XG4gIGRhdGE6IGFycmF5KFN1aU9iamVjdFJlc3BvbnNlKSxcbiAgbmV4dEN1cnNvcjogb3B0aW9uYWwoQ2hlY2twb2ludGVkT2JqZWN0SWQpLFxuICBoYXNOZXh0UGFnZTogYm9vbGVhbigpLFxufSk7XG5leHBvcnQgdHlwZSBQYWdpbmF0ZWRPYmplY3RzUmVzcG9uc2UgPSBJbmZlcjx0eXBlb2YgUGFnaW5hdGVkT2JqZWN0c1Jlc3BvbnNlPjtcblxuLy8gbWlycm9ycyBzdWlfanNvbl9ycGNfdHlwZXM6OiBTdWlPYmplY3REYXRhRmlsdGVyXG5leHBvcnQgdHlwZSBTdWlPYmplY3REYXRhRmlsdGVyID1cbiAgfCB7IFBhY2thZ2U6IE9iamVjdElkIH1cbiAgfCB7IE1vdmVNb2R1bGU6IHsgcGFja2FnZTogT2JqZWN0SWQ7IG1vZHVsZTogc3RyaW5nIH0gfVxuICB8IHsgU3RydWN0VHlwZTogc3RyaW5nIH07XG5cbmV4cG9ydCB0eXBlIFN1aU9iamVjdFJlc3BvbnNlUXVlcnkgPSB7XG4gIGZpbHRlcj86IFN1aU9iamVjdERhdGFGaWx0ZXI7XG4gIG9wdGlvbnM/OiBTdWlPYmplY3REYXRhT3B0aW9ucztcbn07XG4iXX0=