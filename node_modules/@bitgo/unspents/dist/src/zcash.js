"use strict";
// https://zips.z.cash/zip-0317
Object.defineProperty(exports, "__esModule", { value: true });
exports.getConventionalFeeForDimensions = exports.getLogicalActions = void 0;
const dimensions_1 = require("./dimensions");
const marginalFeeZatPerAction = 5000;
const graceActions = 2;
const p2pkhStandardInputSize = 150;
const p2pkhStandardOutputSize = 34;
function getLogicalActions(params) {
    if (params instanceof dimensions_1.Dimensions) {
        return getLogicalActions({ txInTotalSize: params.getInputsVSize(), txOutTotalSize: params.getOutputsVSize() });
    }
    // The ZIP includes nJoinSplits, nSpendsSapling, nOutputsSapling, nActionsOrchard
    // which are not relevant for BitGo transactions.
    return Math.max(Math.ceil(params.txInTotalSize / p2pkhStandardInputSize), Math.ceil(params.txOutTotalSize / p2pkhStandardOutputSize));
}
exports.getLogicalActions = getLogicalActions;
function getConventionalFeeForDimensions(dimensions, params = {}) {
    var _a;
    return (Math.max(getLogicalActions(dimensions), graceActions) * ((_a = params.marginalFeeZatPerAction) !== null && _a !== void 0 ? _a : marginalFeeZatPerAction));
}
exports.getConventionalFeeForDimensions = getConventionalFeeForDimensions;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiemNhc2guanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvemNhc2gudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLCtCQUErQjs7O0FBRS9CLDZDQUEwQztBQUUxQyxNQUFNLHVCQUF1QixHQUFHLElBQUksQ0FBQztBQUNyQyxNQUFNLFlBQVksR0FBRyxDQUFDLENBQUM7QUFDdkIsTUFBTSxzQkFBc0IsR0FBRyxHQUFHLENBQUM7QUFDbkMsTUFBTSx1QkFBdUIsR0FBRyxFQUFFLENBQUM7QUFFbkMsU0FBZ0IsaUJBQWlCLENBQUMsTUFBc0U7SUFDdEcsSUFBSSxNQUFNLFlBQVksdUJBQVUsRUFBRTtRQUNoQyxPQUFPLGlCQUFpQixDQUFDLEVBQUUsYUFBYSxFQUFFLE1BQU0sQ0FBQyxjQUFjLEVBQUUsRUFBRSxjQUFjLEVBQUUsTUFBTSxDQUFDLGVBQWUsRUFBRSxFQUFFLENBQUMsQ0FBQztLQUNoSDtJQUNELGlGQUFpRjtJQUNqRixpREFBaUQ7SUFDakQsT0FBTyxJQUFJLENBQUMsR0FBRyxDQUNiLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLGFBQWEsR0FBRyxzQkFBc0IsQ0FBQyxFQUN4RCxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxjQUFjLEdBQUcsdUJBQXVCLENBQUMsQ0FDM0QsQ0FBQztBQUNKLENBQUM7QUFWRCw4Q0FVQztBQUVELFNBQWdCLCtCQUErQixDQUM3QyxVQUFzQixFQUN0QixTQUVJLEVBQUU7O0lBRU4sT0FBTyxDQUNMLElBQUksQ0FBQyxHQUFHLENBQUMsaUJBQWlCLENBQUMsVUFBVSxDQUFDLEVBQUUsWUFBWSxDQUFDLEdBQUcsQ0FBQyxNQUFBLE1BQU0sQ0FBQyx1QkFBdUIsbUNBQUksdUJBQXVCLENBQUMsQ0FDcEgsQ0FBQztBQUNKLENBQUM7QUFURCwwRUFTQyIsInNvdXJjZXNDb250ZW50IjpbIi8vIGh0dHBzOi8vemlwcy56LmNhc2gvemlwLTAzMTdcblxuaW1wb3J0IHsgRGltZW5zaW9ucyB9IGZyb20gJy4vZGltZW5zaW9ucyc7XG5cbmNvbnN0IG1hcmdpbmFsRmVlWmF0UGVyQWN0aW9uID0gNTAwMDtcbmNvbnN0IGdyYWNlQWN0aW9ucyA9IDI7XG5jb25zdCBwMnBraFN0YW5kYXJkSW5wdXRTaXplID0gMTUwO1xuY29uc3QgcDJwa2hTdGFuZGFyZE91dHB1dFNpemUgPSAzNDtcblxuZXhwb3J0IGZ1bmN0aW9uIGdldExvZ2ljYWxBY3Rpb25zKHBhcmFtczogeyB0eEluVG90YWxTaXplOiBudW1iZXI7IHR4T3V0VG90YWxTaXplOiBudW1iZXIgfSB8IERpbWVuc2lvbnMpOiBudW1iZXIge1xuICBpZiAocGFyYW1zIGluc3RhbmNlb2YgRGltZW5zaW9ucykge1xuICAgIHJldHVybiBnZXRMb2dpY2FsQWN0aW9ucyh7IHR4SW5Ub3RhbFNpemU6IHBhcmFtcy5nZXRJbnB1dHNWU2l6ZSgpLCB0eE91dFRvdGFsU2l6ZTogcGFyYW1zLmdldE91dHB1dHNWU2l6ZSgpIH0pO1xuICB9XG4gIC8vIFRoZSBaSVAgaW5jbHVkZXMgbkpvaW5TcGxpdHMsIG5TcGVuZHNTYXBsaW5nLCBuT3V0cHV0c1NhcGxpbmcsIG5BY3Rpb25zT3JjaGFyZFxuICAvLyB3aGljaCBhcmUgbm90IHJlbGV2YW50IGZvciBCaXRHbyB0cmFuc2FjdGlvbnMuXG4gIHJldHVybiBNYXRoLm1heChcbiAgICBNYXRoLmNlaWwocGFyYW1zLnR4SW5Ub3RhbFNpemUgLyBwMnBraFN0YW5kYXJkSW5wdXRTaXplKSxcbiAgICBNYXRoLmNlaWwocGFyYW1zLnR4T3V0VG90YWxTaXplIC8gcDJwa2hTdGFuZGFyZE91dHB1dFNpemUpXG4gICk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRDb252ZW50aW9uYWxGZWVGb3JEaW1lbnNpb25zKFxuICBkaW1lbnNpb25zOiBEaW1lbnNpb25zLFxuICBwYXJhbXM6IHtcbiAgICBtYXJnaW5hbEZlZVphdFBlckFjdGlvbj86IG51bWJlcjtcbiAgfSA9IHt9XG4pOiBudW1iZXIge1xuICByZXR1cm4gKFxuICAgIE1hdGgubWF4KGdldExvZ2ljYWxBY3Rpb25zKGRpbWVuc2lvbnMpLCBncmFjZUFjdGlvbnMpICogKHBhcmFtcy5tYXJnaW5hbEZlZVphdFBlckFjdGlvbiA/PyBtYXJnaW5hbEZlZVphdFBlckFjdGlvbilcbiAgKTtcbn1cbiJdfQ==